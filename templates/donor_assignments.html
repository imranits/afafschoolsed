{% extends "layout.html" %}
{% block content %}
<div class="mb-3 text-start">
  <a href="{{ url_for('home') }}" class="btn btn-outline-primary">🏠 Home</a>
</div>

<div class="container mt-4">
  <h3>🎓 Donor Assignments Report</h3>

  <form method="get" class="row g-3 mb-3">
    <div class="col-md-3">
      <input type="text" name="student_name" value="{{ student_name }}" class="form-control" placeholder="Filter by Student Name">
    </div>
    <div class="col-md-3">
      <input type="text" name="donor_name" value="{{ donor_name }}" class="form-control" placeholder="Filter by Donor Name">
    </div>
    <div class="col-md-3">
      <input type="text" name="application_no" value="{{ application_no }}" class="form-control" placeholder="Filter by Application No">
    </div>
    <div class="col-md-3 d-flex">
      <button type="submit" class="btn btn-primary me-2">🔍 Search</button>
      <a href="{{ url_for('donor_assignments', student_name=student_name, donor_name=donor_name, application_no=application_no, export='excel') }}" class="btn btn-success">📥 Export Excel</a>
    </div>
  </form>

  <table class="table table-striped table-bordered">
    <thead>
      <tr>
        <th>Application No</th>
        <th>Student Name</th>
        <th>Father Name</th>
        <th>Donor Name</th>
        <th>Donor Mobile</th>
        <th>Status</th>
        <th>Assigned Date</th>
      </tr>
    </thead>
    <tbody>
      {% for r in rows %}
      <tr>
        <td>{{ r.application_no }}</td>
        <td>{{ r.student_name }}</td>
        <td>{{ r.father_name }}</td>
        <td>{{ r.donor_name }}</td>
        <td>{{ r.donor_mobile or '' }}</td>
        <td>{{ r.status }}</td>
        <td>{{ r.created_at.strftime('%Y-%m-%d') if r.created_at else '' }}</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
